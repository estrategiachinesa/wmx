
{
  "entities": {
    "LinkConfig": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LinkConfig",
      "type": "object",
      "description": "Stores application affiliate and support links.",
      "properties": {
        "hotmartUrl": {
          "type": "string",
          "format": "uri",
          "description": "The affiliate link for the Hotmart product."
        },
        "exnovaUrl": {
          "type": "string",
          "format": "uri",
          "description": "The affiliate link for the Exnova broker."
        },
        "iqOptionUrl": {
          "type": "string",
          "format": "uri",
          "description": "The affiliate link for the IQ Option broker."
        },
        "telegramUrl": {
          "type": "string",
          "format": "uri",
          "description": "The link to the support group on Telegram."
        }
      },
      "required": [
        "hotmartUrl",
        "exnovaUrl",
        "iqOptionUrl",
        "telegramUrl"
      ]
    },
    "LimitConfig": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "LimitConfig",
        "type": "object",
        "description": "Stores usage limits for the application.",
        "properties": {
            "hourlySignalLimit": {
                "type": "number",
                "description": "The number of signals a non-premium user can generate per hour."
            }
        },
        "required": ["hourlySignalLimit"]
    },
    "StrategyConfig": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "StrategyConfig",
        "type": "object",
        "description": "Stores parameters for the signal generation strategy.",
        "properties": {
            "correlationChance": {
                "type": "number",
                "description": "The probability (0 to 1) that a signal will follow the general market trend."
            }
        },
        "required": ["correlationChance"]
    },
    "ChineseStrategy": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChineseStrategy",
      "type": "object",
      "description": "Represents a Chinese trading strategy.  This entity stores the details of a specific trading strategy, including its name, description, and rules.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Chinese Strategy entity."
        },
        "name": {
          "type": "string",
          "description": "The name of the trading strategy."
        },
        "description": {
          "type": "string",
          "description": "A detailed explanation of the strategy, including its principles and rules."
        },
        "rules": {
          "type": "string",
          "description": "The specific rules that define the strategy. Includes entry and exit criteria"
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time when the strategy was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "The date and time when the strategy was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "rules",
        "createdAt",
        "updatedAt"
      ]
    },
    "VipRequest": {
      "title": "VIP Access Request",
      "description": "Stores a user's request for VIP access after signing up through an affiliate link.",
      "type": "object",
      "properties": {
        "brokerId": {
          "type": "string",
          "description": "The user's ID from the brokerage account.",
          "pattern": "^[0-9]{8,}$"
        },
        "userId": {
          "type": "string",
          "description": "The Firebase Authentication UID of the user."
        },
        "userEmail": {
          "type": "string",
          "format": "email",
          "description": "The email of the user requesting access."
        },
        "status": {
          "type": "string",
          "description": "The current status of the VIP request.",
          "enum": [
            "PENDING",
            "AWAITING_DEPOSIT",
            "DEPOSIT_PENDING",
            "APPROVED",
            "REJECTED"
          ]
        },
        "submittedAt": {
          "type": "string",
          "description": "The date and time when the request was submitted.",
          "format": "date-time"
        }
      },
      "required": [
        "brokerId",
        "userId",
        "status",
        "submittedAt"
      ]
    },
    "SignalHistory": {
      "title": "Signal History",
      "description": "Stores a record of a signal generated for a user.",
      "type": "object",
      "properties": {
        "asset": {
          "type": "string",
          "description": "The asset for which the signal was generated."
        },
        "expirationTime": {
          "type": "string",
          "enum": ["1m", "5m"],
          "description": "The expiration time of the signal."
        },
        "signal": {
          "type": "string",
          "enum": ["CALL ðŸ”¼", "PUT ðŸ”½"],
          "description": "The direction of the signal."
        },
        "targetTime": {
          "type": "string",
          "description": "The target entry time for the signal (HH:MM)."
        },
        "status": {
          "type": "string",
          "enum": ["pending", "win", "loss", "tie"],
          "description": "The outcome of the signal."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the signal was generated."
        }
      },
      "required": ["asset", "expirationTime", "signal", "targetTime", "status", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
       {
        "path": "/appConfig/links",
        "definition": {
          "entityName": "LinkConfig",
          "schema": {
            "$ref": "#/backend/entities/LinkConfig"
          },
          "description": "Stores global application affiliate links. This is a single document."
        }
      },
      {
        "path": "/appConfig/limitation",
        "definition": {
          "entityName": "LimitConfig",
          "schema": {
            "$ref": "#/backend/entities/LimitConfig"
          },
          "description": "Stores global application usage limits. This is a single document."
        }
      },
      {
        "path": "/appConfig/strategy",
        "definition": {
          "entityName": "StrategyConfig",
          "schema": {
            "$ref": "#/backend/entities/StrategyConfig"
          },
          "description": "Stores global strategy parameters. This is a single document."
        }
      },
      {
        "path": "/chineseStrategies/{chineseStrategyId}",
        "definition": {
          "entityName": "ChineseStrategy",
          "schema": {
            "$ref": "#/backend/entities/ChineseStrategy"
          },
          "description": "Stores all Chinese strategy documents.",
          "params": [
            {
              "name": "chineseStrategyId",
              "description": "The unique identifier for a Chinese strategy document."
            }
          ]
        }
      },
      {
        "path": "/vipRequests/{userId}",
        "definition": {
          "entityName": "VipRequest",
          "schema": {
            "$ref": "#/backend/entities/VipRequest"
          },
          "description": "Stores VIP access requests from users. The document ID is the user's Firebase UID.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/signalHistory/{signalId}",
        "definition": {
          "entityName": "SignalHistory",
          "schema": {
            "$ref": "#/backend/entities/SignalHistory"
          },
          "description": "Stores the history of signals generated by a specific user.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Authentication UID of the user."
            },
            {
              "name": "signalId",
              "description": "The unique identifier for a signal history record."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to store Chinese trading strategies and VIP access requests. The design prioritizes simplicity. All Chinese Strategy documents are stored in a single collection, `/chineseStrategies`. VIP requests are stored in `/vipRequests`, with the document ID being the user's UID to ensure each user can only have one request, simplifying management and validation. The `/appConfig` collection now holds multiple singleton documents (`links`, `limitation`, `strategy`) for different types of global configuration, allowing them to be updated dynamically without code changes. The `/users/{userId}/signalHistory` subcollection stores signal history per user for easy retrieval and secure access. This supports secure operations as rules can be applied based on user authentication state and document ownership."
  }
}

    